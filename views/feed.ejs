<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/stylesheets/feed.css">
    <title>Feed</title>
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->
</head>

<body>
    <div class="container">
        <div class="navbar">
            <h1>SocialBuzz</h1>
            <div class="links">
                <a href="/search">
                    <div class="navbtn"><svg xmlns="http://www.w3.org/2000/svg" height="35px" width="35px"
                            viewBox="0 0 24 24" fill="currentColor">
                            <path
                                d="M18.031 16.6168L22.3137 20.8995L20.8995 22.3137L16.6168 18.031C15.0769 19.263 13.124 20 11 20C6.032 20 2 15.968 2 11C2 6.032 6.032 2 11 2C15.968 2 20 6.032 20 11C20 13.124 19.263 15.0769 18.031 16.6168ZM16.0247 15.8748C17.2475 14.6146 18 12.8956 18 11C18 7.1325 14.8675 4 11 4C7.1325 4 4 7.1325 4 11C4 14.8675 7.1325 18 11 18C12.8956 18 14.6146 17.2475 15.8748 16.0247L16.0247 15.8748Z">
                            </path>
                        </svg>Search</div>
                </a>
                <a href="/upload">
                    <div class="navbtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="35"
                            height="35" fill="currentColor">
                            <path
                                d="M13.0001 10.9999L22.0002 10.9997L22.0002 12.9997L13.0001 12.9999L13.0001 21.9998L11.0001 21.9998L11.0001 12.9999L2.00004 13.0001L2 11.0001L11.0001 10.9999L11 2.00025L13 2.00024L13.0001 10.9999Z">
                            </path>
                        </svg>Create</div>
                </a>
                <a href="/profile">
                    <div class="navbtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="35"
                            height="35" fill="currentColor">
                            <path
                                d="M20 22H18V20C18 18.3431 16.6569 17 15 17H9C7.34315 17 6 18.3431 6 20V22H4V20C4 17.2386 6.23858 15 9 15H15C17.7614 15 20 17.2386 20 20V22ZM12 13C8.68629 13 6 10.3137 6 7C6 3.68629 8.68629 1 12 1C15.3137 1 18 3.68629 18 7C18 10.3137 15.3137 13 12 13ZM12 11C14.2091 11 16 9.20914 16 7C16 4.79086 14.2091 3 12 3C9.79086 3 8 4.79086 8 7C8 9.20914 9.79086 11 12 11Z">
                            </path>
                        </svg>Profile</div>
                </a>
            </div>
        </div>
        <div class="main">
            <% posts.reverse().forEach(function(elem){ %>
                <div class="postcontainer">
                    <div class="postheader">
                        <div class="userimg" style="background-color: lightblue;"><img
                                src="/images/uploads/<%=elem.user.profileImage%>" onerror="this.style.display='none'"
                                height="100%" width="100%"></div>
                        <h1>
                            <%= elem.user.username %>
                        </h1>
                        <span style="padding-bottom: 20px; color: grey;">&#9679;</span>
                        <p>
                            <%=moment(elem.createdAt).fromNow()%>
                        </p>
                    </div>
                    <div class="postbody">
                        <img src="/images/uploads/<%=elem.image%>" height="100%" width="100%" alt="not supported">
                    </div>
                    <div class="postcaption">
                        <h1>
                            <%=elem.postCaption %>
                        </h1>
                    </div>
                    <div class="postfooter">
                        <div class="postleft">
                            <div class="postlike">
                                <div class="likeicon">
                                    <a style="cursor: pointer; text-decoration: none; color: rgb(0, 0, 0);"
                                        href="/like/post/<%=elem._id%>">
                                        <% if(elem.likes.indexOf(user._id) !==-1 ){ %>
                                            <svg style="cursor: pointer;" xmlns="http://www.w3.org/2000/svg"
                                                viewBox="0 0 24 24" width="40" height="40" fill="red">
                                                <path
                                                    d="M12.001 4.52853C14.35 2.42 17.98 2.49 20.2426 4.75736C22.5053 7.02472 22.583 10.637 20.4786 12.993L11.9999 21.485L3.52138 12.993C1.41705 10.637 1.49571 7.01901 3.75736 4.75736C6.02157 2.49315 9.64519 2.41687 12.001 4.52853Z">
                                                </path>
                                            </svg>

                                            <% } else { %>
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="40"
                                                    height="40" fill="currentColor">
                                                    <path
                                                        d="M12.001 4.52853C14.35 2.42 17.98 2.49 20.2426 4.75736C22.5053 7.02472 22.583 10.637 20.4786 12.993L11.9999 21.485L3.52138 12.993C1.41705 10.637 1.49571 7.01901 3.75736 4.75736C6.02157 2.49315 9.64519 2.41687 12.001 4.52853ZM18.827 6.1701C17.3279 4.66794 14.9076 4.60701 13.337 6.01687L12.0019 7.21524L10.6661 6.01781C9.09098 4.60597 6.67506 4.66808 5.17157 6.17157C3.68183 7.66131 3.60704 10.0473 4.97993 11.6232L11.9999 18.6543L19.0201 11.6232C20.3935 10.0467 20.319 7.66525 18.827 6.1701Z">
                                                    </path>
                                                </svg>
                                                <% } %>
                                    </a>
                                </div>
                                <h1>
                                    <%=elem.likes.length%> Likes
                                </h1>
                            </div>
                            <div class="postcomment">
                                <div class="commenticon">
                                    <a style="color: black;" href="/commentSection/<%=elem._id%>">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="40" height="40"
                                        fill="currentColor">
                                        <path
                                            d="M10 3H14C18.4183 3 22 6.58172 22 11C22 15.4183 18.4183 19 14 19V22.5C9 20.5 2 17.5 2 11C2 6.58172 5.58172 3 10 3ZM12 17H14C17.3137 17 20 14.3137 20 11C20 7.68629 17.3137 5 14 5H10C6.68629 5 4 7.68629 4 11C4 14.61 6.46208 16.9656 12 19.4798V17Z">
                                        </path>
                                    </svg>
                                    </a>
                                    
                                </div>
                                <h1><%=elem.comments.length%> comments</h1>
                                       
                            </div>
                        </div>
                        <div class="postright">
                            <form action="/comment/post/<%=elem._id %>" method="post">
                                <div class="comment-input">
                                <textarea name="comment" placeholder="enter comment"></textarea>
                                <button>post</button>
                            </div>
                        </form>
                            
                        </div>
                    </div>
                </div>
                <% }) %>

        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", function (event) {
            var scrollpos = localStorage.getItem('scrollpos');
            if (scrollpos) window.scrollTo(0, scrollpos);
        });

        window.onbeforeunload = function (e) {
            localStorage.setItem('scrollpos', window.scrollY);
        };
    </script>
</body>

</html>